### 第八章 区间评估

  在第七章中，我们陈述了点评估是用于估计总体参数的样本统计。举例来说：
  * 样本均值是总体均值的点评估
  * 样本比例是总体比例的点评估。
  
  因为点评估不能期望提供总体参数的精确值，区间估计通常为点估计通过加减一个叫做误差幅度的值来计算。区间评估的一般形式为:点评估±误差幅度。
  
  区间估计的目的是为总体参数值提供点估计的密集程度的信息，由样本提供。
  
  本章我们展示如何计算总体均值μ及总体比例p的区间估计。 
  * 总体均值的区间估计形式一般为: x̄±误差幅度
  * 总体比例的区间估计形式一般为: p̄±误差幅度
  x̄和p̄的样本分布在计算这些区间估计中扮演重要角色。

### 8.1 总体均值: σ已知
  要开发总体均值的区间估计，总体标准方差σ已知或样本的标准方差s已知之一必须用来计算误差幅度。
  
  在大多数应用中σ未知，使用s来计算误差幅度。然而在有些应用中，有大量历史数据可用，可用于估计总体标准方差，优于使用样本估计。在质量控制应用中，假设过程是操作无误或受控的，那么也可以将总体的标准方差视为已知的。我们称这些为σ已知情况。在本节我们将介绍一个有必要将σ视为已知的例子， 并展示如何为这个例子构建区间估计。
  
  劳埃德商场每周都会随机抽样100个顾客，为的是了解平均每次购买的消费总额。x代表每次购买花的总金额，样本均值x̄是对总体均值μ的点估计， 即该百货公司顾客每次购买花费的平均总额。劳埃德已经多年使用这样的周调查了。 基于历史数据，假设总体的标准方差已知，值为σ=20美元。历史数据也表明总体服从正态分布。
  
  在最近一周， 劳埃德调查了100(n=100)个顾客并且获得样本均值为82美元。样本平均花费金额是对总体均值花费金额的点估计。接下来我们将展示如何为这种估计计算误差幅度以及如何对总体均值进行区间估计开发。
  
  误差幅度和区间估计
  在第七章我们展示了x̄的样本分布可用于计算x̄在给定距离μ的之间的概率。即均值在nμ上下差异之间的概率(正态分布结论)。

  在劳埃德的例子中，历史数据表明花费金额的总体是正态分布的，标准方差为σ=20。 因此，使用我们在第七章中所学的， 可以总结出样本x̄服从正态分布，标准误差σ<sub>x̄</sub>=σ/√n=20/√100=2. 
  这个样本分布在图8.1中展示出来。因为样本分布展示了x̄是如何围绕总体均值μ分布的，x̄的样本分布提供了关于x̄和μ差异的概率。
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_8.1.png)
  
  使用标准正态概率表，我们可以查到95%的正态分布随机变量在标准方差的±1.96均值之间。因此当x̄样本分布是正态分布的，95%的x̄必须在μ±1.96σ<sub>x̄</sub>之内。在劳埃德的例子中我们知道x̄样本是正态分布的，标准方差σ<sub>x̄</sub>=2.因为±1.9σ<sub>x̄</sub>=1.96*2=3.92。
  我们可以总结95%的所有x̄在总体均值μ±3.92之间。
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_8.2.png)
  
  在本章简介中我们说到总体均值μ的区间估计的一般形式为x̄±误差幅度。 对劳埃德的例子来说，假设我们将误差幅度设置为3.92，那么计算μ的误差幅度为x̄±3.92. 为了给这个区间估计提供一些解释， 我们考虑x̄可以是从三个不同的简单随机样本中获得的， 每个由100个顾客组成。 具体情况见8.3图。
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_8.3.png)
  
  置信水平:置信水平是指总体参数值落在样本统计值某一区内的概率，一般用1-α表示。 百分比
  置信区间:是指在某一置信水平下，样本统计值与总体参数值间误差范围。置信区间越大，置信水平越高。
  
  总体均值区间估计: σ已知
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_formula_8.1.png)
  其中置信系数为1-α, z<sub>α/2</sub>为正态概率分布右尾提供面积为α/2的z值。
  
  让我们看上面劳埃德构建95%置信区间的例子。 对于95%的置信区间，置信系数为1-α=0.95, 因此α=0.05. 使用正态概率分布表， 面积为α/2＝0.05/2=0.025的右尾提供z<sub>0.025</sub> = 1.96. 使用劳埃德的样本均值x̄=􏰐82,σ=20, 样本大小n=100,那么
  82±1.96*20/√100 = 82±3.92
  
  因此使用公式8.1, 误差幅度为3.92， 95%的置信区间是78.08到85.92.
  
  虽然95%的置信级别经常使用， 其他置信级别比如90%，99%也要考虑。 最常用的z<sub>α/2</sub>值置信级别在表8.1中列出。 使用这些值和表达式，可以相应计算90%置信级别的置信区间。
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_table_8.1.png)
  
  实践建议
  如果总体遵循正态分布，由表达式8.1提供的置信区间是准确的。 换句话说，如果表达式8.1用于重复产生95%置信区间，几乎产生的区间95%将包含总体均值。如果总体不遵循正态分布，使用表达式8.1提供的置信区间也是近似的。这种情况下，近似的质量取决于总体的分布以及样本大小。
  
  在多数应用中，样本尺寸n≥30使用表达式8.1开发总体均值的置信区间是充足的。如果总体不是正态分布的，但是是大致对称的，样本大小小到15可以期望提供好的近似置信区间。 使用较小的样本大小，表达式8.1将只用于如果分析师相信或者希望假设总体分布至少近似正态分布。
  
  注意:
  1. 本节讨论的区间估计基于假设总体标准方差σ已知。对于σ已知我们意思是历史数据或者其他信息可以用于允许我们比用样本获取更好的总体标准方差估计。因此，技术上来讲，我们不意味着σ当然实际已知的。 我们仅仅意味着我们比使用样本获得了更好的标准方差的估计，因此我们不使用样本同时去估计总体均值和总体标准方差。
  2. 样本尺寸n出现在表达式8.1的区间估计的分母中(denominator). 因此，如果特定的样本尺寸提供了过宽的区间，没有实际应用意义， 那么我们可以加大样本尺寸。 因为n在分母中，较大的n提供较小的误差幅度， 一个较窄的置信区间， 更高的精确度。我们在第8.3节介绍如何为简单随机样本确定样本尺寸，以便获得想要精确度。
  
### 总体均值: σ未知
  当在开发总体均值区间估计的时候，我们通常也没有办法获得总体标准方差的较好估计。 这些情况下， 我们必须使用同样的样本来同时估计μ和σ。 这种情况就代表σ未知的情况。这时候使用s来估计σ， 总体均值的误差幅度以及区间估计是基于所谓的t分布的概率分布。 虽然t分布的数学发展是基于抽样总体是服从正态分布的，但是研究表明t分布也可成功应用于那些总体显著偏离正态分布的情况。本节后面我们会提供一些如果总体不是正态分布时，使用t分布的一些建议。

  t分布是类似概率分布的一个家族， 对于特定t分布依赖一个所谓叫做自由度的参数。t分布具有1个自由度为唯一的，t分布具有2个自由度，具有3个自由度，等等。自由度的数字增加， t分布和正态分布之间的差异越来越小。 图8.4展示了t分布具有10和20个自由度，它们和标准正态分布的差异。 注意t分布自由度越高，表明更小的变异性，更加接近正态分布。注意t分布的均值是0.
  
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_graph_8.4.png)

  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_complete_t_dist_table.png)
  更详细的见附录表中，列举了详细的t分布表。
  
  关于总体均值的区间估计:σ未知
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_formula_8.2.png)
  
  实践建议
  如果总体遵循正态分布， 表达式8.2提供的置信区间是准确的，可以用于任何尺寸的样本。 如果样本不服从正态分布， 8.2表达式提供的置信区间是近似的。这个情况下，近似的质量同时依赖于总体的分布和样本的大小。
  在大多数应用中， 使用8.2表达式开发总体均值的区间估计时，样本尺寸n≥30足够了。然而如果总体分布严重倾斜或包含有离群值， 很多分析学家推荐增加样本尺寸到50或者更多。 如果总体不是正态分布，但是分布基本上是对称的，样本尺寸可以最少取到15， 还能提供较好的近似置信区间。 表达式8.2使用较小的样本尺寸，仅仅在分析家相信或者希望假设总体分布至少近似正态分布的。
  
  区间估计过程总结
  我们提供了两种方法开发总体均值的区间估计。 对于σ已知， σ和标准正态分布用于8.1来计算误差幅度以及开发区间估计。
  对于σ未知， 样本标准方差s和t分布用于表达式8.2来计算误差幅度和开发区间估计。
  
  区间估计过程的总结展示在图8.8. 对于大多数应用，样本尺寸n≥30足够了。 如果总体具有正态或近似正态分布， 那么可以使用较小的样本尺寸。
  ![](https://github.com/walkerqiao/walkman/blob/master/images/da/sfbe_graph_8.8.png)
  
  对于σ未知情况，推荐使用样本尺寸n≥50，如果总体分布是严重倾斜或具有离群值。
  
  注意
  1. 当σ已知，误差幅度是固定的，对于所有样本尺寸来说都是相同的。 当σ未知， 误差幅度随着样本不同而不同。 这种变化发生是因为样本标准方差s依赖选择的样本变化而变化。 s较大，提供的误差幅度也大；s较小，提供的误差幅度也较小。
  2. 当总体倾斜的时候，置信区间会发生什么变化? 考虑总体向右倾斜， 大值集中分布在右边。 当这种倾斜存在时，样本均值以及样本标准方差是正相关的。 较大的s值导致相关的较大样本均值，当样本均值比总体均值大， s趋近于比总体方差σ大。 这种倾斜导致误差幅度比σ已知的情况要大。 置信区间带有较大的误差幅度趋向包含总体均值μ比真正σ值被使用的要大。 但是均值比总体均值小， 相对应的样本均值以及s导致误差幅度较小。 这种情况，置信区间具有较小的误差幅度，失去总体均值跟多，如果我们知道σ并使用它。由于这个原因， 我们推荐对倾斜度比较大的总体分布使用更大的样本尺寸。 (这里的翻译还需要进一步修改，不够准确。)
  
### 8.3 确定样本尺寸
  在提供的实践建议中，我们推荐在总体不是正态分布的时候，样本尺寸角色提供对较好的置信区间近似有帮助。
  本节我们聚焦另外一个方面，样本尺寸的问题。 我们描述如何选择样本尺寸足够提供想要的误差幅度。要理解这个过程如何工作，我们返回到σ已知的情况。


### 标准正态分布
  标准正态分布是均值μ=0，标准方差σ=1的正态分布，记为N(0,1)，也称为u分布。
  * 在-1.96~+1.96范围内曲线下面的面积等于0.95
  * 在-2.58~+2.58范围内曲线下面的面积等于0.99
  
  μ±nσ范围内概率(曲线下面积)
  * 68.268949%的面积在平均数左右的一个标准差范围内。
  * 95.449974%的面积在平均数左右两个标准差的范围内。
  * 99.730020%的面积在平均数左右三个标准差的范围内。
  * 99.993666%的面积在平均数左右四个标准差的范围内。
  
  ![](https://github.com/walkerqiao/walkman/blob/master/images/sfbe_std_normal_1.png)

  深蓝色区域是距平均值小于一个标准差之内的数值范围。在正态分布中，此范围所占比率为全部数值之68%，根据正态分布，两个标准差之内的比率合起来为95%；三个标准差之内的比率合起来为99%。
  在实际应用上，常考虑一组数据具有近似于正态分布的概率分布。
  若其假设正确，则:
  * 约68.3%数值分布在距离平均值有1个标准差之内的范围
  * 约95.4%数值分布在距离平均值有2个标准差之内的范围
  * 约99.7%数值分布在距离平均值有3个标准差之内的范围。
  称为"68-95-99.7法则"或"经验法则"。

  ![](https://github.com/walkerqiao/walkman/blob/master/images/sfbe_std_normal_2.png)
  
