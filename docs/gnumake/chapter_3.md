## 变量与宏
  到目前为止，我们已经看过了makefile的变量以及将它们应用在内置和具体规则中的许多范例。不过这些都只是粗浅的例子。变量和宏越复杂，GNU make的功能就越强大。
  
  在我们继续任何探讨之前，最好能先了解make所包含的两种语言。第一种语言用来描述工作目标与必要条件所组成的依存图。 第二种语言是宏语言，用来进行文字的替换。你可能已经熟悉其他的宏语言，像C预处理器、m4、TeX以及宏汇编器。 如同这些其他的宏语言，make允许你为较长的字符序列定义见血并在你的程序中使用该简写，宏处理器将会认出你的简写并将它们替换成展开后的形式。虽然你可以把makefile的变量想成传统程序语言的变量，不过宏变量和传统变量之间是有差别的。宏变量会被就地执行扩展，其所产生的文本字符串还可以做进一步的扩展。 继续读下去，这个差别将会变得更加明显。
  
  一个变量名称几乎可以由任意字符组成，包括大部分的标点符号。即使空格也可以使用，单如果你自认精神正常，就应该避免这么做。事实上只有:、#和=等字符不允许使用在变量名称中。
  
  变量名称是区分大小写的，所以cc和CC所指的是不同的变量。要取得某个变量的值，请用$()扩住该变量的名称。有一个特例: 变量名称若为单一字母则可以省略圆括号，所以请直接使用$letter. 这就是为何自动变量的指定不必使用圆括号。一个原则是: 指定变量名称时应该加上圆括号，避免使用单一字母的变量名称。
  
  你还可以使用花括号来扩展变量，例如${CC}。 事实上，你将会经常看到这种做法，尤其在比较旧的makefile文件中。很难说使用哪个会比较好，所以请选择一使用，选定后务必维持其一致性。有些人的做法会像shell那样，将花括号用于变量的引用，将圆括号用于函数的调用。现代化的makefile多半会使用圆括号，这也是本书将采用的方法。
  
  当变量用来表示用户在命令行上或环境变量中所自定义的常量时，习惯上会全部以大写来编写其名称，单词之间以下划线隔开。 至于只在makefile文件中使用的变量，则会全部以小写来编写其名称，单词之间以下划线符号隔开。最后，在本书中，内含用户自定义函数的变量以及宏都会以小写来编写其名称，单词之间以中划线隔开。其他的命名习惯将会适时加以说明。
```
# 常量
CC      := gcc
MKDIR   := mkdir -p

# 内部变量
sources = *.c
objects = $(subst .c,.o,$(sources))

# 函数
maybe-make-dir    = $(if $(wildcard $1),, $(MKDIR) $1)
assert-not-null   = $(if $1,, $(eroor Illegal null value.))
```

  一个变量的值由赋值符号右边已删除前导空格的所有字符组成。 跟在所有字之后的空格则不会删除。这有时会导致问题，举例来说，如果变量的值包含了跟在后面的空格，而且随后被使用在命令脚本中:
```
LIBRARY = libio.a # LIBRARY 的值包含了一个跟在后面的空格
missing_file:
  touch $(LIBRARY)
  ls -l | grep '$(LIBRARY)'
```
  变量后面跟着空格，加上注释符号之后，这会变得显而易见。对这个makefile运行make, 将会得到如下的结果:
```
bogon:test apple$ make
touch libio.a 
ls -l | grep 'libio.a '
make: *** [missing_file] Error 1
```
  因为grep的搜索字符串也包含了跟在后面的空格，所以无法在ls输出中找到该文件的名称。稍后我们会深入探讨空格的相关细节。现在让我们进一步讨论变量吧.
  
  
  
